# 虚拟内存原理

在系统中运行的每个进程都需要适用到内存, 但不是每个进程都需要每时每刻使用系统分配的内存空间, 当系统运行所需内存超过实际的物理内存时, 内核会释放某些进程所占用但未使用的部分或所有物理内存, 将这部分资料存储在磁盘上直到进程下一次调用, 并将释放出的内存提供给有需要的进程使用

在linux内存管理中, 主要是通过"调页Paging"和"交换Swapping"来完成内存调度, 调页算法是将内存中最近不常使用的页面换到磁盘上, 把活动页面保留在内存中供进程使用, 交换技术是将整个进程, 而不是部分页面, 全部交换到磁盘上

分页(Page)写入磁盘的过程被称作Page-Out, 分页从磁盘重新回到内存的过程被称作Page-In, 当内核需要一个分页, 但发现此分页不在物理内存中时(因为已经被Page-Out了), 此时就发生了分页错误(Page Fault)

当系统内核发现可运行内存变少时, 就会通过Page-Out来释放一部分物理内存. Page-Out一般不经常发生, 如果频繁不断的发生, 直到当内核管理分页的时间超过运行程式的时间时, 系统效能会急剧下降, 这时的系统已经运行非常慢或进入暂停状态, 这种状态被称作thrashing(颠簸)

