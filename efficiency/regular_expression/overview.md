# 正则表达式 (regular expression)

在编写处理字符串的程序或网页时, 经常会有查找符合某些复杂规则的字符串的需要, 正则表达式就是用于描述这些规则的工具. 换句话说, 正则表达式就是记录文本规则的代码

## 元字符 (metacharacter)

```
.    匹配除换行符(\n, \r)以外的任意字符, 要匹配包括'\n', 可使用像 (.|\n) 的模式
^    匹配输入字符串的开始位置
$    匹配输入字符串的结束位置
*    匹配前面的子表达式零次或多次, 如 zo* 能匹配 z 以及 zoo
+    匹配前面的子表达式一次或多次, 如 zo+ 能匹配 zo 以及 zoo
?    匹配前面的子表达式零次或一次, 如 do(es)? 可以匹配 do 或 does
{n}    n是一个非负整数, 匹配确定的n次, 如 0{2} 可以匹配 food
{n,}    n是一个非负整数, 至少匹配n次
{n,m}    m和n均为非负整数, 其中n<m, 最少匹配n次且最多匹配m次
(pattern)    匹配pattern并获取这一匹配
(?:pattern)    匹配pattern但不获取匹配结果, 如 industr(?:y|ies) 
(?=pattern)    正向肯定预查(look ahead positive assert), 非获取匹配, 在任何匹配pattern的字符串开始处匹配查找字符串, 如 Windows(?=95|98|NT|2000) 能匹配Windows2000中的Windows, 但不能匹配Windows3.1中的Windows
(?!pattern)    正向否定预查(negative assert), 非获取匹配, 在任何不匹配pattern的字符串开始处匹配查找字符串
(?<=pattern)    反向(look behind)肯定预查, 如 (?<=95|98|NT|2000)Windows 能匹配2000Windowsz中的Windows, 但不能匹配3.1Windows中的Windows
(?<!pattern)    反向否定预查
x|y    匹配x或y
[xyz]    字符集合, 匹配所包含的任意一个字符
[^xyz]    负值字符集合, 匹配未包含的任意字符
[a-z]    字符范围, 匹配指定范围内的任意字符
[^a-z]    负值字符范围, 匹配任何不在指定范围内的任意字符
\b    匹配一个单词边界, 也就是指单词和空格间的位置, 如 er\b 可以匹配never中的er, 不能匹配verb中的er
\B    匹配非单词边界, 如 er\B 能匹配verb中的er, 但不能匹配never中的er
\cx    匹配由x指明的控制字符, 如 \cM 匹配一个Control-M或回车符, x的值必须是A-Z或a-z之一
\d    匹配一个数字字符, 等价于[0-9]
\D    匹配一个非数字字符, 等价于[^0-9]
\f    匹配一个换页符, 等价于\x0c和\cL
\n    匹配一个换行符, 等价于\x0d和\cJ
\r    匹配一个回车符, 等价于\x0d和\cM
\w    匹配字母, 数字, 下划线
\W    匹配非字母、数字、下划线
\s    匹配任意的空白字符, 包括空格, 制表符, 换页符等, 等价于[\f\n\r\t\v]
\S    匹配任何非空白字符
\t    匹配一个制表符
\v    匹配一个垂直制表符
\xn    匹配n, n为十六进制转义值, 十六进制转义值必须为确定的两个数字长, 如 \x41 匹配A, \x041 则等价于 \x04 & 1, 正则表达式中可以使用ASCII编码
\num    匹配num, num是一个正整数, 对所获取的匹配的引用, 如 (.)\1 匹配两个连续的相同字符
```

## 贪婪和非贪婪模式

1. 贪婪匹配模式
正则表达式去匹配时, 会尽量多地匹配符合条件的内容 <br/>

标识符
```
+ ? * {n} {n,} {n,m}
```

2. 非贪婪匹配模式
正则表达式去匹配时, 会尽量少地匹配符合条件的内容 <br/>
也就是说, 一旦发现匹配符合要求, 立马就匹配成功

标识符
```
+? ?? *? {n}? {n,}? {n,m}?
```

## 实例

### `(pattern)`, `(?:pattern)`, `(?=pattern)`
```
var str = "heihei 2333";
str.match(/heihei (?:2222|2333|1211)/)  //['heihei 2333']
str.match(/heihei (?=2222|2333|1211)/)  //['heihei ']
str.match(/heihei (?!=2222)/)  //['heihei ']
str.match(/dadiao (2222|2333|1211)/)  //['heihei 2333', '2333']
```

### 正则表达式括号嵌套匹配

```
(1 + 2)(1 + (1 + 2))

/^\(([^()]*(\(.*\))*[^()]*)*\)\(([^()]*(\(.*\))*[^()\*)*\)$/

\1    (1 + 2)
\2
\3    (1 + (1 + 2))
\4    (1+2)
```

### 排除特定字符串

1. 查找不以某个字符串开头的行
```
baidu.com
sina.com.cn

^(?!baidu).*$
```

2. 查找不以某个字符串结尾的行
```
www.sina.com.cn
www.educ.org
www.baidu.com
www.123.com
www.hoa.cc

^.*?(?<!com)$
```

3. 查找不含有某个字符串的行
```
if (a>b)
    printf("hello");
else if (a<b)
    printf("hello2");
else
    printf("hello3")

^([^f] | [^i]f)+$
^(?!.*hello).*$
```
